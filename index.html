<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Looping Video Gallery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #060712;
      color: #f5f5f5;
    }

    header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }

    header p {
      margin: 0;
      font-size: 0.9rem;
      opacity: 0.75;
    }

    main {
      padding: 2rem;
    }

    .grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }

    .video-card {
      background: radial-gradient(circle at top left, #15182b, #05060d);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .video-card h2 {
      margin: 0 0 0.5rem;
      font-size: 1rem;
    }

    .video-meta {
      font-size: 0.75rem;
      opacity: 0.7;
      margin-bottom: 0.75rem;
    }

    video {
      width: 100%;
      display: block;
      border-radius: 0.75rem;
      outline: none;
      background: black;
    }

    .note {
      margin-top: 1rem;
      font-size: 0.75rem;
      opacity: 0.8;
    }

    @media (max-width: 600px) {
      header, main {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Looping Video Page</h1>
      <p>Each video loops between a custom start and end time.</p>
    </div>
  </header>

  <main>
    <section class="grid">
      <!-- VIDEO 1 -->

        <article class="video-card">
        <h2>TEST</h2>
        <div class="video-meta">
          Loop from <span>2s</span> to <span>8s</span>.
        </div>
        <video
          src="videos/first_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          muted
          preload="auto"
          data-start="0"
          data-end="5"
        ></video>
      </article>
      
      
      <article class="video-card">
        <h2>Video 1</h2>
        <div class="video-meta">
          Loop from <span>2s</span> to <span>8s</span>.
        </div>
        <video
          src="videos/first_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          muted
          preload="auto"
          data-start="27"
          data-end="66"
        ></video>
      </article>

      <!-- VIDEO 2 -->
      <article class="video-card">
        <h2>Merenge 1</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="0"
          data-end="13"
        ></video>
      </article>

            <!-- VIDEO 3 -->
      <article class="video-card">
        <h2>Merenge 2</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="13"
          data-end="22"
        ></video>
      </article>

              <!-- VIDEO 4 -->
      <article class="video-card">
        <h2>Bembe - 1</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="29"
          data-end="55"
        ></video>
      </article>


                    <!-- VIDEO 4 -->
      <article class="video-card">
        <h2>Bembe - 2</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="55"
          data-end="74"
        ></video>
      </article>

      <article class="video-card">
        <h2>Bembe - 3</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="74"
          data-end="88"
        ></video>
      </article>


      <article class="video-card">
        <h2>Bembe - 4</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_a_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="88"
          data-end="93"
        ></video>
      </article>


      <article class="video-card">
        <h2>Quinto - 16 beat</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_b_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="11"
          data-end="20"
        ></video>
      </article>

    <article class="video-card">
        <h2>Quinto - 1</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_b_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="20"
          data-end="31"
        ></video>
      </article>

    <article class="video-card">
        <h2>Quinto - 2</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_b_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="31"
          data-end="43"
        ></video>
      </article>

      <article class="video-card">
        <h2>Quinto - language</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/second_b_vid_ffmpeg.mp4"
          controls
          playsinline
          webkit-playsinline
          preload="auto"
          data-start="43"
          data-end="63"
        ></video>
      </article>
      <!-- Add more <article class="video-card"> blocks for more videos -->
    </section>

    

    <p class="note">
      Tip: Autoplay on mobile usually requires videos to be <strong>muted</strong> and
      <strong>playsinline</strong>, which is why those attributes are set by default.
    </p>
  </main>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    var videos = document.querySelectorAll("video[data-start][data-end]");

    // Turn NodeList into an array-like loop for older browsers
    Array.prototype.forEach.call(videos, function (video) {
      var start = parseFloat(video.getAttribute("data-start")) || 0;
      var end = parseFloat(video.getAttribute("data-end"));
      var loopTimer = null;

      video.addEventListener("loadedmetadata", function () {
        var duration = video.duration;

        // Clamp values into valid range
        if (start < 0) start = 0;
        if (isNaN(end) || end <= start) {
          end = duration - 0.05;
        }
        if (end > duration) {
          end = duration - 0.05;
        }

        // Store adjusted values in data-* attributes
        video.setAttribute("data-loop-start", start);
        video.setAttribute("data-loop-end", end);

        // Start the video at the loop start
        if (start < duration) {
          video.currentTime = start;
        }
      });

      // When user presses play, start a timer to enforce the loop
      video.addEventListener("play", function () {
        var loopStartAttr =
          video.getAttribute("data-loop-start") ||
          video.getAttribute("data-start");
        var loopEndAttr =
          video.getAttribute("data-loop-end") ||
          video.getAttribute("data-end");

        var loopStart = parseFloat(loopStartAttr) || 0;
        var loopEnd = parseFloat(loopEndAttr);

        // Make sure we start inside the loop window
        if (
          video.currentTime < loopStart ||
          (!isNaN(loopEnd) && video.currentTime > loopEnd)
        ) {
          video.currentTime = loopStart;
        }

        // Clear any existing timer
        if (loopTimer) clearInterval(loopTimer);

        // Check position regularly while playing
        loopTimer = setInterval(function () {
          if (video.paused || video.readyState < 2) return;

          var now = video.currentTime;

          var sAttr =
            video.getAttribute("data-loop-start") ||
            video.getAttribute("data-start");
          var eAttr =
            video.getAttribute("data-loop-end") ||
            video.getAttribute("data-end");

          var s = parseFloat(sAttr) || 0;
          var e = parseFloat(eAttr);

          if (!isNaN(e) && now >= e) {
            // Jump back near the start; no extra play() needed
            video.currentTime = s + 0.01;
          }
        }, 80);
      });

      // Stop timer when paused
      video.addEventListener("pause", function () {
        if (loopTimer) {
          clearInterval(loopTimer);
          loopTimer = null;
        }
      });

      // Also clear timer when playback ends
      video.addEventListener("ended", function () {
        if (loopTimer) {
          clearInterval(loopTimer);
          loopTimer = null;
        }
      });
    });
  });
</script>




</body>
</html>
