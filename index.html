<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Looping Video Gallery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #060712;
      color: #f5f5f5;
    }

    header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }

    header p {
      margin: 0;
      font-size: 0.9rem;
      opacity: 0.75;
    }

    main {
      padding: 2rem;
    }

    .grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }

    .video-card {
      background: radial-gradient(circle at top left, #15182b, #05060d);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .video-card h2 {
      margin: 0 0 0.5rem;
      font-size: 1rem;
    }

    .video-meta {
      font-size: 0.75rem;
      opacity: 0.7;
      margin-bottom: 0.75rem;
    }

    video {
      width: 100%;
      display: block;
      border-radius: 0.75rem;
      outline: none;
      background: black;
    }

    .note {
      margin-top: 1rem;
      font-size: 0.75rem;
      opacity: 0.8;
    }

    @media (max-width: 600px) {
      header, main {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Looping Video Page</h1>
      <p>Each video loops between a custom start and end time.</p>
    </div>
  </header>

  <main>
    <section class="grid">
      <!-- VIDEO 1 -->
      <article class="video-card">
        <h2>Video 1</h2>
        <div class="video-meta">
          Loop from <span>2s</span> to <span>8s</span>.
        </div>

        <!--
          IMPORTANT:
          - Replace "videos/video1.mp4" with your file path.
          - data-start / data-end are in SECONDS.
        -->
        <video
          src="videos/first_vid_ffmpeg.mp4"
          controls
          muted
          playsinline
          data-start="27"
          data-end="66"
        ></video>
      </article>

      <!-- VIDEO 2 -->
      <article class="video-card">
        <h2>Merenge 1</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="0"
          data-end="13"
        ></video>
      </article>

            <!-- VIDEO 3 -->
      <article class="video-card">
        <h2>Merenge 2</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="13"
          data-end="22"
        ></video>
      </article>

              <!-- VIDEO 4 -->
      <article class="video-card">
        <h2>Bembe - 1</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="29"
          data-end="55"
        ></video>
      </article>


                    <!-- VIDEO 4 -->
      <article class="video-card">
        <h2>Bembe - 2</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="55"
          data-end="74"
        ></video>
      </article>

      <article class="video-card">
        <h2>Bembe - 3</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="74"
          data-end="88"
        ></video>
      </article>


      <article class="video-card">
        <h2>Bembe - 4</h2>
        <div class="video-meta">
          Loop from <span>5s</span> to <span>12.5s</span>.
        </div>

        <video
          src="videos/shorten_a.mp4"
          controls
          muted
          playsinline
          data-start="88"
          data-end="93"
        ></video>
      </article>

      <!-- Add more <article class="video-card"> blocks for more videos -->
    </section>

    <p class="note">
      Tip: Autoplay on mobile usually requires videos to be <strong>muted</strong> and
      <strong>playsinline</strong>, which is why those attributes are set by default.
    </p>
  </main>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const videos = document.querySelectorAll("video[data-start][data-end]");

    videos.forEach((video) => {
      let start = parseFloat(video.dataset.start) || 0;
      let end = parseFloat(video.dataset.end);

      video.addEventListener("loadedmetadata", () => {
        const duration = video.duration;
        console.log("Video duration:", duration, "seconds");

        // Clamp start & end into valid range
        if (start < 0) start = 0;
        if (isNaN(end) || end <= start) {
          console.warn("Invalid end time, defaulting to full duration");
          end = duration - 0.05;
        }
        if (end > duration) {
          console.warn("data-end is beyond duration, clamping.", { end, duration });
          end = duration - 0.05;
        }

        // Jump to the start of the loop
        video.currentTime = Math.min(start, duration - 0.05);

        // Store the (possibly adjusted) values so timeupdate uses them
        video.dataset._loopStart = start;
        video.dataset._loopEnd = end;
      });

      video.addEventListener("timeupdate", () => {
        const loopStart = parseFloat(video.dataset._loopStart ?? video.dataset.start) || 0;
        const loopEnd = parseFloat(video.dataset._loopEnd ?? video.dataset.end);

        if (!isNaN(loopEnd) && video.currentTime >= loopEnd) {
          // Jump back to the loop start
          video.currentTime = loopStart + 0.01;
          if (!video.paused) {
            video.play();
          }
        }
      });

      // Optional: when user hits play, make sure we start inside the loop
      video.addEventListener("play", () => {
        const loopStart = parseFloat(video.dataset._loopStart ?? video.dataset.start) || 0;
        const loopEnd = parseFloat(video.dataset._loopEnd ?? video.dataset.end);
        if (video.currentTime < loopStart || (!isNaN(loopEnd) && video.currentTime > loopEnd)) {
          video.currentTime = loopStart;
        }
      });
    });
  });
</script>

</body>
</html>
